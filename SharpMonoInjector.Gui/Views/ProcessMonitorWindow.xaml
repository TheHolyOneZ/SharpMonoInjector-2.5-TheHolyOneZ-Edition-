<Window x:Class="SharpMonoInjector.Gui.Views.ProcessMonitorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:SharpMonoInjector.Gui.Views"
        mc:Ignorable="d"
        Title="Process Monitor" Height="320" Width="800"
        WindowStyle="None" 
        ResizeMode="NoResize" 
        Background="#FF1A1A1A"
        AllowsTransparency="True">
    <Border BorderBrush="#FF00E676" BorderThickness="1" CornerRadius="8">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="40"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <Border Grid.Row="0" Background="#FF000000" CornerRadius="8,8,0,0" MouseLeftButtonDown="Window_MouseLeftButtonDown">
                <Grid>
                    <TextBlock Text="⚡ PROCESS MONITOR" Foreground="#FF00E676" FontWeight="Bold" VerticalAlignment="Center" Margin="15,0"/>
                    <Button Content="✕" Width="40" Height="30" Background="Transparent" Foreground="#FFFFFFFF" BorderThickness="0" FontSize="16" Click="Window_Exit" Cursor="Hand" HorizontalAlignment="Right" Margin="0,0,10,0"/>
                </Grid>
            </Border>

            <Grid Grid.Row="1" Margin="20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="20"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0">
                    <Label Content="Add Process to Watch" Style="{StaticResource ModernLabel}"/>
                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="10"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBox Grid.Column="0" Style="{StaticResource ModernTextBox}" Text="{Binding Path=WatchProcessName, UpdateSourceTrigger=PropertyChanged}"/>
                        <Button Grid.Column="2" Content="➕ Add" Style="{StaticResource SecondaryButton}" Command="{Binding Path=AddWatchProcessCommand}"/>
                    </Grid>

                    <Label Content="Watched Processes" Style="{StaticResource ModernLabel}"/>
                    <ListBox Style="{StaticResource ModernListBox}" Height="100" ItemsSource="{Binding Path=WatchedProcesses}">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="35"/>
                                        <ColumnDefinition Width="30"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                        <TextBlock Text="{Binding ProcessName}" FontWeight="SemiBold" Foreground="#FFFFFFFF"/>
                                        <TextBlock FontSize="10" Foreground="#FF808080" Margin="0,2,0,0">
                                            <Run Text="→"/>
                                            <Run>
                                                <Run.Style>
                                                    <Style TargetType="Run">
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding UseCurrentSettings}" Value="True">
                                                                <Setter Property="Text" Value="Current Settings"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding UseCurrentSettings}" Value="False">
                                                                <Setter Property="Text" Value="{Binding Profile.Name, FallbackValue='No Profile'}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Run.Style>
                                            </Run>
                                        </TextBlock>
                                    </StackPanel>
                                    <Button Grid.Column="1" Content="⚙" Style="{StaticResource SettingsButton}" Command="{Binding DataContext.SetWatchProfileCommand, RelativeSource={RelativeSource AncestorType=ListBox}}" CommandParameter="{Binding}" ToolTip="Set injection profile"/>
                                    <Button Grid.Column="2" Content="✕" Style="{StaticResource DeleteButton}" Command="{Binding DataContext.RemoveWatchProcessCommand, RelativeSource={RelativeSource AncestorType=ListBox}}" CommandParameter="{Binding}" ToolTip="Remove from watch list"/>
                                </Grid>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </StackPanel>

                <StackPanel Grid.Column="2" VerticalAlignment="Top" Width="220">
                    <CheckBox Style="{StaticResource ModernCheckBox}" Content="Auto-Inject on Detection" IsChecked="{Binding Path=AutoInject}" Margin="0,25,0,10" ToolTip="Automatically inject when watched process is detected"/>
                    <CheckBox Style="{StaticResource ModernCheckBox}" Content="Show Notifications" IsChecked="{Binding Path=ShowNotifications}" Margin="0,0,0,10" ToolTip="Show desktop notifications when process detected"/>
                    
                    <CheckBox Style="{StaticResource ModernCheckBox}" 
                            Content="Scan Only for Mono Games" 
                            IsChecked="{Binding Path=ScanOnlyMonoGames}" 
                            Margin="0,0,0,20"
                            ToolTip="Filters the 'Refresh' list to only show common Mono/Unity games."/>

                    <Button Content="{Binding Path=MonitorButtonText}" Style="{StaticResource ModernButton}" Command="{Binding Path=ToggleMonitorCommand}" Height="45" FontSize="13" HorizontalAlignment="Stretch"/>
                </StackPanel>
            </Grid>
        </Grid>
    </Border>
</Window>